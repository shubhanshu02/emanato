<!doctype html>
<html class="no-js" lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<title>Shopping Cart || Tarun Kirana Store</title>
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
		<!-- Place favicon.ico in the root directory -->
		
		<!-- Google Font -->
		<link href='https://fonts.googleapis.com/css?family=Lato:400,700,900' rel='stylesheet' type='text/css'>
		<link href='https://fonts.googleapis.com/css?family=Bree+Serif' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">


		<!-- all css here -->
		<!-- bootstrap v3.3.6 css -->
		<link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
		<!-- animate css -->
		<link rel="stylesheet" th:href="@{/css/animate.css}">
		<!-- jquery-ui.min css -->
		<link rel="stylesheet" th:href="@{/css/jquery-ui.min.css}">
		<!-- meanmenu css -->
		<link rel="stylesheet" th:href="@{/css/meanmenu.min.css}">
		<!-- nivo-slider css -->
		<link rel="stylesheet" th:href="@{/lib/css/nivo-slider.css}">
		<link rel="stylesheet" th:href="@{/lib/css/preview.css}">
		<!-- slick css -->
		<link rel="stylesheet" th:href="@{/css/slick.css}">
		<!-- lightbox css -->
		<link rel="stylesheet" th:href="@{/css/lightbox.min.css}">
		<!-- material-design-iconic-font css -->
		<link rel="stylesheet" th:href="@{/css/material-design-iconic-font.css}">
		<!-- All common css of theme -->
		<link rel="stylesheet" th:href="@{/css/default.css}">
		<!-- style css -->
		<link rel="stylesheet" th:href="@{/style.css}">
        <!-- shortcode css -->
        <link rel="stylesheet" th:href="@{/css/shortcode.css}">
		<!-- responsive css -->
		<link rel="stylesheet" th:href="@{/css/responsive.css}">
		<!-- modernizr css -->
		<script th:src="@{/js/vendor/modernizr-2.8.3.min.js}"></script>
	</head>
	<body>	
		<!-- WRAPPER START -->
		<div class="wrapper bg-dark-white">

			<header id="sticky-menu" class="header">
				<div class="header-area">
					<div class="container-fluid">
						<div class="row">
							<div class="col-sm-4 col-sm-offset-4 col-xs-7">
								<div class="logo text-center">
									<a th:href="@{/}">
                                        <h3 class="rooster">
                                            Tarun Kirana Store
                                        </h3>
								</div>
							</div>
							<div class="col-sm-4 col-xs-5">
								<div class="mini-cart text-right">
									<ul>
										<li>
											<a th:href="@{/cart}" class="cart-icon" href="#">
												<i class="zmdi zmdi-shopping-cart"></i>
												<span>3</span>
											</a>
										</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- MAIN-MENU START -->
				<div class="menu-toggle hamburger hamburger--emphatic hidden-xs">
					<div class="hamburger-box">
						<div class="hamburger-inner"></div>
					</div>
				</div>
				<div class="main-menu  hidden-xs">
					<nav>
						<ul>
							<li><a th:href="@{/}">Home</a></li>
							<li><a sec:authorize="isAnonymous()" th:href="@{/login}">Login</a></li>
							<li><a sec:authorize="isAnonymous()" th:href="@{/register}">Register</a></li>
							<li><a th:href="@{/catalog}">Catalog</a></li>
							<li sec:authorize="hasRole('ROLE_STAFF')"><a href="#">Staff Pages</a>
								<div class="sub-menu menu-scroll">
									<ul>
										<li class="menu-title">Page's</li>
										<li><a th:href="@{/catalog}">Shop</a></li>
										<li><a th:href="@{/addProduct}">Add a new Product</a></li>
										<li><a th:href="@{/categories}">Add/View Categories</a></li>
									</ul>
								</div>
							</li>
							<li><a th:href="@{contact}">contact</a></li>
							<li><a sec:authorize="isAuthenticated()" th:href="@{/account}">My Account</a></li>
							<li><a sec:authorize="isAuthenticated()" th:href="@{/logout}">Logout</a></li>
						</ul>
					</nav>
				</div>
				<!-- MAIN-MENU END -->
			</header>
			<!-- HEADER-AREA END -->
			<!-- Mobile-menu start -->
			<div class="mobile-menu-area">
				<div class="container-fluid">
					<div class="row">
						<div class="col-xs-12 hidden-lg hidden-md hidden-sm">
							<div class="mobile-menu">
								<nav id="dropdown">
									<ul>
										<li><a th:href="@{/}">Home</a></li>
										<li><a sec:authorize="isAnonymous()" th:href="@{/login}">Login</a></li>
										<li><a sec:authorize="isAnonymous()" th:href="@{/register}">Register</a></li>
										<li><a th:href="@{/catalog}">Catalog</a></li>
										<li sec:authorize="hasRole('ROLE_STAFF')"><a href="#">Staff Pages</a>
											<ul>
												<li><a th:href="@{/catalog}">Shop</a></li>
												<li><a th:href="@{/addProduct}">Add a new Product</a></li>
												<li><a th:href="@{/categories}">Add/View Categories</a></li>
											</ul>
										</li>
										<li><a th:href="@{contact}">contact</a></li>
										<li><a sec:authorize="isAuthenticated()" th:href="@{/account}">My Account</a></li>
										<li><a sec:authorize="isAuthenticated()" th:href="@{/logout}">Logout</a></li>
									</ul>
								</nav>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Mobile-menu end -->
			<!-- HEADING-BANNER START -->
			<div class="heading-banner-area overlay-bg">
				<div class="container">
					<div class="row">
						<div class="col-md-12">
							<div class="heading-banner">
								<div class="heading-banner-title">
									<h2>Shopping Cart</h2>
								</div>
								<div class="breadcumbs pb-15">
									<ul>
										<li><a th:href="@{/}">Home</a></li>
										<li>Shopping Cart</li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- HEADING-BANNER END -->
			<!-- SHOPPING-CART-AREA START -->
			<div class="shopping-cart-area  pt-80 pb-80">
				<div class="container">	
					<div class="row">
						<div class="col-md-12 col-sm-12 col-xs-12">
							<div class="shopping-cart">

								<!-- Tab panes -->
								<div class="tab-content">
									<!-- shopping-cart start -->
									<div class="tab-pane active" id="shopping-cart">
											<div class="shop-cart-table">
												<div class="table-content table-responsive">
													<table>
														<thead>
															<tr>
																<th class="product-thumbnail">Product</th>
																<th class="product-price">Price</th>
																<th class="product-quantity">Quantity</th>
																<th class="product-subtotal">Total</th>
																<th class="product-remove">Remove</th>
															</tr>
														</thead>
														<tbody>
															<tr th:each="cartItem: ${cartItems}" th:with="prod=${cartProduct.get(cartItem)}">
																<td class="product-thumbnail  text-left">
																	<!-- Single-product start -->
																	<div class="single-product">
																		<div class="product-img">
																			<a th:href="${'product/' + prod.getId}"><img th:src="${prod.getPhotosImagePath}" style="height: 11rem; width: 11rem;" alt="" /></a>
																		</div>
																		<div class="product-info">
																			<h4 class="post-title"><a class="text-light-black" th:href="${'product/' + prod.getId}" th:text="${prod.productName}">dummy product name</a></h4>
																			<p class="mb-0">Size : <span th:text="${prod.size}" /></p>
																		</div>
																	</div>
																	<!-- Single-product end -->
																</td>
																<td class="product-price">₹<span th:text="${prod.mrp}" /></td>
																<td class="product-quantity">
																	<div class="cart-plus-minus">
																		<div class="text-left">
																			<input type="hidden" disabled name="id" th:value="${prod.id}">
																			<input
																				th:id="${'quantity-' + prod.id}"
																				type="text" th:value="${cartItem.quantity}" name="quantity"
																				min="1" th:max="${prod.quantityAvailable}"
																				class="cart-plus-minus-box">
																		</div>
																	</div>
																	<button th:onClick="updateItemQuantity([[${prod.id}]])" data-text="edit" class="button-one quantity-edit-button mt-15">Edit</button>
																</td>
																<td class="product-subtotal" th:with="total = ${prod.mrp * cartItem.quantity}"><span th:text="${total}" /></td>
																<td class="product-remove">
																	<a th:onClick="deleteCartItem([[${prod.id}]])"><i class="zmdi zmdi-close"></i></a>
																</td>
															</tr>
														</tbody>
													</table>
													<script>
														function updateItemQuantity(id) {
															const quantity = parseInt(document.getElementById('quantity-' + id).value);
															$.ajax({
																url: "/update/cartItem",
																type: "POST",
																data: {
																	id, quantity
																},
																success: function(data) {
																	console.log(data)
																	if (data == "true")
																		alert("Updated");
																	else
																		alert("Couldn't update. Reloading");
																	window.location.reload();
																}
															});
														}


														function deleteCartItem(id) {
															$.ajax({
																url: "/delete/cartItem",
																type: "delete",
																data: {
																	id
																},
																success: function(data) {
																	console.log(data)
																	if (data == "true")
																		alert("Deleted");
																	else
																		alert("Couldn't delete. Reloading");
																	window.location.reload();
																}
															});
														}
													</script>
												</div>
											</div>
											<div class="row">
												<div class="col-md-6 col-sm-6 col-xs-12">
													<div class="customer-login payment-details mt-30">
														<h4 class="title-1 title-border text-uppercase">payment details</h4>
														<table>
															<tbody>
																<tr>
																	<td class="text-left">Cart Subtotal</td>
																	<td class="text-right">₹ <span th:text="${orderTotal - 15 - 35}" /></td>
																</tr>
																<tr>
																	<td class="text-left">Processing Fee</td>
																	<td class="text-right">₹15.00</td>
																</tr>
																<tr>
																	<td class="text-left">Delivery Fees</td>
																	<td class="text-right">₹35</td>
																</tr>
																<tr>
																	<td class="text-left">Order Total</td>
																	<td class="text-right">₹ <span th:text="${orderTotal}" /> </td>
																</tr>
															</tbody>
														</table>
													</div>
												</div>
												<div class="col-md-6 col-sm-6 col-xs-12">
													<div class="customer-login mt-30">
														<!--
														<h4 class="title-1 title-border text-uppercase">coupon discount</h4>
														<p class="text-gray">Enter your coupon code if you have one!</p>
														<input type="text" placeholder="Enter your code here.">
														<button type="submit" data-text="apply coupon" class="button-one submit-button mt-15">apply coupon</button>
														-->
														<h4 class="title-1 title-border text-uppercase">Place Order</h4>
														<p class="text-gray">Enter your address and phone number below!</p>
														<input id="mob" type="text" placeholder="Enter Mobile Number">
														<textarea id="address" class="custom-textarea" placeholder="Enter Address..." required></textarea>
														<div class="text-right">
															<button onClick="finalSubmit()" data-text="get a quote" class="button-one submit-button mt-15">Place Order</button>
														</div>
													</div>
													<script>
														function finalSubmit() {
															const mobile = document.getElementById('mob').value.trim();
															const address = document.getElementById('address').value.trim();
															if (!mobile || mobile.length !== 10) alert("Enter a valid mobile number!");
															else if (!address) alert("Enter a valid address!");
															$.ajax({
																url: "/add/order",
																type: "POST",
																data: {
																	mobile, address
																},
																success: function(data) {
																	console.log(data)
																	if (data == "no") {
																		alert("Couldn't place the order. Reloading");
																		windows.location.reload();
																	}
																	else {
																		alert("Success");
																		window.location.replace(data);
																	}
																}
															});
														}
													</script>
												</div>
											</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- SHOPPING-CART-AREA END -->
			<!-- FOOTER START -->
			<footer>
				<!-- Footer-area start -->
				<div class="footer-area footer-3">
					<div class="container">
						<div class="row">
							<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
								<div class="single-footer">
									<h3 class="footer-title  title-border">Contact Us</h3>
									<ul class="footer-contact">
										<li><span>Address :</span>48 G64, Jhalawar Road<br>Kota, India</li>
										<li><span>Cell-Phone :</span>+91 39883988</li>
										<li><span>Email :</span>tk.store@tkstore.com</li>
									</ul>
								</div>
							</div>
							<div class="col-lg-4 col-md-4 col-sm-3 col-xs-12">
								<div class="single-footer">
									<h3 class="footer-title  title-border">accounts</h3>
									<ul class="footer-menu">
										<li><a th:href="@{/account}"><i class="zmdi zmdi-dot-circle"></i>My Account</a></li>
										<li><a th:href="@{/cart}"><i class="zmdi zmdi-dot-circle"></i>My Cart</a></li>
										<li><a th:href="@{/login}"><i class="zmdi zmdi-dot-circle"></i>Sign In</a></li>
										<li><a th:href="@{/register}"><i class="zmdi zmdi-dot-circle"></i>Register</a></li>
									</ul>
								</div>
							</div>
							<div class="col-lg-4 col-md-4 col-sm-3 col-xs-12">
								<div class="single-footer">
									<h3 class="footer-title  title-border">For Staff</h3>
									<ul class="footer-menu">
										<li><a th:href="@{/addProduct}"><i class="zmdi zmdi-dot-circle"></i>Add Products</a></li>
										<li><a th:href="@{/categories}"><i class="zmdi zmdi-dot-circle"></i>Add/View Categories</a></li>
									</ul>
								</div>

								<div style="margin-top: 20px;">
									<h3 class="footer-title  title-border">Products</h3>
									<ul class="footer-menu">
										<li><a th:href="@{/catalog}"><i class="zmdi zmdi-dot-circle"></i>Catalog</a></li>
										<li><a th:href="@{/contact}"><i class="zmdi zmdi-dot-circle"></i>Contact Us</a></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- Footer-area end -->
				<!-- Copyright-area start -->
				<div class="copyright-area">
					<div class="container">
						<div class="row">
							<div class="col-sm-6 col-xs-12">
								<div class="copyright">
									<p class="mb-0">Copyright <i class="fa fa-copyright"></i> 2021 <span><a href="#" >Tarun Kirana Store</a></span> . All rights reserved. </p>
								</div>
							</div>
							<div class="col-sm-6 col-xs-12">
								<div class="payment  text-right">
									<a href="#"><img src="img/payment/1.png" alt="" /></a>
									<a href="#"><img src="img/payment/2.png" alt="" /></a>
									<a href="#"><img src="img/payment/3.png" alt="" /></a>
									<a href="#"><img src="img/payment/4.png" alt="" /></a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<!-- Copyright-area start -->
			</footer>
			<!-- FOOTER END -->
			<!-- QUICKVIEW PRODUCT -->
		</div>
		<!-- WRAPPER END -->

		<!-- all js here -->
		<!-- jquery latest version -->
		<script th:src="@{/js/vendor/jquery-1.12.0.min.js}"></script>
		<!-- bootstrap js -->
		<script th:src="@{/js/bootstrap.min.js}"></script>
		<!-- jquery.meanmenu js -->
		<script th:src="@{/js/jquery.meanmenu.js}"></script>
		<!-- slick.min js -->
		<script th:src="@{/js/slick.min.js}"></script>
		<!-- jquery.treeview js -->
		<script th:src="@{/js/jquery.treeview.js}"></script>
		<!-- lightbox.min js -->
		<script th:src="@{/js/lightbox.min.js}"></script>
		<!-- jquery-ui js -->
		<script th:src="@{/js/jquery-ui.min.js}"></script>
		<!-- jquery.nivo.slider js -->
		<script th:src="@{lib/js/jquery.nivo.slider.js}"></script>
		<script th:src="@{lib/home.js}"></script>
		<!-- jquery.nicescroll.min js -->
		<script th:src="@{/js/jquery.nicescroll.min.js}"></script>
		<!-- countdon.min js -->
		<script th:src="@{/js/countdon.min.js}"></script>
		<!-- wow js -->
		<script th:src="@{/js/wow.min.js}"></script>
		<!-- plugins js -->
		<script th:src="@{/js/plugins.js}"></script>
		<!-- main js -->
		<script th:src="@{/js/main.js}"></script>
	</body>
</html>
